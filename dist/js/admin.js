!function(t){"use strict";const e={init:function(){this.bindEvents(),this.initializeColorPickers(),this.checkApiStatus()},bindEvents:function(){t(".password-toggle-btn").on("click",this.togglePasswordVisibility),t("form").on("submit",this.validateForm),t(".phynite-test-connection").on("click",this.testConnection),t('select[name*="environment"]').on("change",this.updateEnvironmentBadge),t("#submit").on("click",this.showSaveConfirmation),t(".phynite-tab").on("click",this.switchTab),t(".phynite-help-toggle").on("click",this.toggleHelp)},togglePasswordVisibility:function(e){e.preventDefault();const n=t(this),i=n.siblings("input");"password"===i.attr("type")?(i.attr("type","text"),n.text(phyniteAdmin.hide)):(i.attr("type","password"),n.text(phyniteAdmin.show))},initializeColorPickers:function(){"undefined"!=typeof wp&&wp.colorPicker&&t('input[type="color"]').wpColorPicker({change:function(e,n){const i=e.target,o=n.color.toString();t(i).val(o).trigger("change")}})},validateForm:function(n){let i=!0;const o=[],s=t('input[name*="api_key"]').val();s&&!s.startsWith("phyn_")&&(o.push('API key should start with "phyn_"'),i=!1);const a=t('input[name*="stewie_url"]').val();a&&!a.match(/^https?:\/\/.+/)?(o.push("Stewie URL must be a valid HTTP/HTTPS URL"),i=!1):a&&a.startsWith("http://")&&!a.includes("localhost")&&(o.push("HTTP URLs are only allowed for localhost development. Use HTTPS for production."),i=!1);const c=t('input[name*="rate_limit"]').val();return c&&(isNaN(c)||c<1||c>60)&&(o.push("Rate limit must be between 1 and 60"),i=!1),i||(n.preventDefault(),e.showErrors(o)),i},testConnection:function(n){n.preventDefault();const i=t(this),o=i.text(),s=t(".phynite-connection-status");i.prop("disabled",!0).text("Testing...").addClass("phynite-loading"),s.html('<div class="phynite-status-indicator checking">Checking API connection...</div>'),t.ajax({url:ajaxurl,type:"POST",data:{action:"phynite_test_connection",nonce:phyniteAdmin.nonce},timeout:1e4,success:function(t){t.success?(s.html('<div class="phynite-status-indicator connected">API connection successful!</div>'),e.showSuccess("API connection test successful")):(s.html('<div class="phynite-status-indicator error">Connection failed: '+t.data.message+"</div>"),e.showError("API connection failed: "+t.data.message))},error:function(t,n,i){let o="Connection test failed";"timeout"===n?o="Connection test timed out":t.responseJSON&&t.responseJSON.message&&(o=t.responseJSON.message),s.html('<div class="phynite-status-indicator error">'+o+"</div>"),e.showError(o)},complete:function(){i.prop("disabled",!1).text(o).removeClass("phynite-loading")}})},checkApiStatus:function(){const e=t('input[name*="api_key"]').val(),n=t('input[name*="stewie_url"]').val();e&&n?(t(".phynite-api-status").html('<div class="phynite-status-indicator checking">Checking API status...</div>'),setTimeout(function(){t(".phynite-test-connection").trigger("click")},1e3)):t(".phynite-api-status").html('<div class="phynite-status-indicator error">API not configured</div>')},updateEnvironmentBadge:function(){const n=t(this).val(),i=t(".phynite-environment-badge"),o=t('input[name*="stewie_url"]');if(i.removeClass("production staging development").addClass(n).text(n.toUpperCase()),o.length&&confirm("Would you like to set the recommended API URL for this environment?")){let t="";switch(n){case"production":case"staging":t="https://api.phynitesolutions.com";break;case"development":t="http://localhost:4000"}t&&(o.val(t),e.showSuccess("API URL updated to: "+t))}},showSaveConfirmation:function(t){if(e.detectChanges()&&!confirm("Are you sure you want to save these settings?"))return t.preventDefault(),!1},switchTab:function(e){e.preventDefault();const n=t(this),i=n.attr("href");t(".phynite-tab").removeClass("active"),n.addClass("active"),t(".phynite-tab-content").hide(),t(i).show(),localStorage.setItem("phynite-active-tab",i)},toggleHelp:function(e){e.preventDefault();const n=t(this);n.next(".phynite-help-content").slideToggle(200),n.toggleClass("expanded")},detectChanges:function(){const e=t("form"),n=e.serialize(),i=e.data("original-data")||n;return e.data("original-data",i),n!==i},showSuccess:function(e){const n=t('<div class="notice notice-success is-dismissible phynite-notice"><p>'+e+"</p></div>");t(".wrap h1").after(n),setTimeout(function(){n.fadeOut(300,function(){t(this).remove()})},5e3)},showError:function(e){const n=t('<div class="notice notice-error is-dismissible phynite-notice"><p>'+e+"</p></div>");t(".wrap h1").after(n)},showErrors:function(e){const n=e.map(t=>"<li>"+t+"</li>").join(""),i=t('<div class="notice notice-error is-dismissible phynite-notice"><ul>'+n+"</ul></div>");t(".wrap h1").after(i)},copyToClipboard:function(t){if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(t).then(function(){e.showSuccess("Copied to clipboard")});else{const n=document.createElement("textarea");n.value=t,n.style.position="absolute",n.style.left="-999999px",document.body.prepend(n),n.select();try{document.execCommand("copy"),e.showSuccess("Copied to clipboard")}catch(t){e.showError("Failed to copy to clipboard")}finally{n.remove()}}},formatCodeExamples:function(){t(".phynite-code").each(function(){const n=t(this),i=n.text().trim(),o=t('<button class="phynite-copy-btn" type="button">Copy</button>');n.append(o),o.on("click",function(t){t.preventDefault(),e.copyToClipboard(i)})})},initTooltips:function(){t.fn.tooltip&&t("[data-tooltip]").tooltip({position:{my:"center bottom-20",at:"center top"},content:function(){return t(this).attr("data-tooltip")}})},autoSaveDraft:function(){const e=t("form");let n;e.find("input, select, textarea").on("change input",function(){clearTimeout(n),n=setTimeout(function(){const n=e.serialize();localStorage.setItem("phynite-draft-settings",n);const i=t(".phynite-draft-indicator");i.text("Draft saved").fadeIn(200),setTimeout(function(){i.fadeOut(200)},2e3)},2e3)})},loadDraftSettings:function(){const n=localStorage.getItem("phynite-draft-settings");n&&(new URLSearchParams(n).forEach((e,n)=>{const i=t('[name="'+n+'"]');i.is(":checkbox")||i.is(":radio")?i.filter('[value="'+e+'"]').prop("checked",!0):i.val(e)}),e.showSuccess("Draft settings loaded"))}};window.togglePasswordVisibility=function(e){const n=t("#"+e);"password"===n.attr("type")?n.attr("type","text"):n.attr("type","password")},t(document).ready(function(){e.init(),e.formatCodeExamples(),e.initTooltips(),e.autoSaveDraft(),"true"===localStorage.getItem("phynite-load-draft")&&(e.loadDraftSettings(),localStorage.removeItem("phynite-load-draft"));const n=localStorage.getItem("phynite-active-tab");n&&t('.phynite-tab[href="'+n+'"]').trigger("click"),t(document).on("click",".notice-dismiss",function(){t(this).closest(".notice").fadeOut(300,function(){t(this).remove()})}),t(document).on("keydown",function(e){(e.ctrlKey||e.metaKey)&&"s"===e.key&&(e.preventDefault(),t("#submit").trigger("click")),(e.ctrlKey||e.metaKey)&&"t"===e.key&&(e.preventDefault(),t(".phynite-test-connection").trigger("click"))})})}(jQuery),"undefined"!=typeof wp&&wp.hooks&&(wp.hooks.addAction("phynite.admin.init","phynite-signup-form",function(){console.log("Phynite Admin initialized")}),wp.hooks.addFilter("phynite.admin.validate","phynite-signup-form",function(t,e){return t}));
//# sourceMappingURL=admin.js.map