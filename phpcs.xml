<?xml version="1.0"?>
<ruleset name="WordPress Plugin Standards">
    <description>Code standards for WordPress plugin</description>

    <!-- Show progress and sniff codes in all reports -->
    <arg value="ps"/>

    <!-- Use colors in output -->
    <arg name="colors"/>

    <!-- Only check PHP files -->
    <arg name="extensions" value="php"/>

    <!-- Check all files in the current directory and subdirectories -->
    <file>.</file>

    <!-- Exclude third party code -->
    <exclude-pattern>*/vendor/*</exclude-pattern>
    <exclude-pattern>*/node_modules/*</exclude-pattern>
    <exclude-pattern>*/build/*</exclude-pattern>
    <exclude-pattern>*/dist/*</exclude-pattern>
    <exclude-pattern>*/coverage/*</exclude-pattern>
    
    <!-- Exclude test files for now to focus on main plugin -->
    <exclude-pattern>*/tests/*</exclude-pattern>
    <exclude-pattern>*/bin/*</exclude-pattern>

    <!-- Include WordPress Coding Standards -->
    <rule ref="WordPress">
        <!-- Allow some database queries for this plugin -->
        <exclude name="WordPress.DB.DirectDatabaseQuery.DirectQuery"/>
        <exclude name="WordPress.DB.DirectDatabaseQuery.NoCaching"/>
        <exclude name="WordPress.DB.DirectDatabaseQuery.SchemaChange"/>
        
        <!-- Allow file names that don't follow WordPress standards -->
        <exclude name="WordPress.Files.FileName.InvalidClassFileName"/>
        <exclude name="WordPress.Files.FileName.NotHyphenatedLowercase"/>
        
        <!-- Allow some parsing functions -->
        <exclude name="WordPress.WP.AlternativeFunctions.parse_url_parse_url"/>
        
        <!-- Disable overly strict documentation rules -->
        <exclude name="Squiz.Commenting.FunctionComment.MissingParamTag"/>
        <exclude name="Squiz.Commenting.FunctionComment.MissingParamComment"/>
        <exclude name="Squiz.Commenting.InlineComment.InvalidEndChar"/>
        <exclude name="Squiz.Commenting.VariableComment.MissingVar"/>
        
        <!-- Allow some security patterns used in this plugin -->
        <exclude name="WordPress.Security.ValidatedSanitizedInput.InputNotValidated"/>
        <exclude name="WordPress.Security.ValidatedSanitizedInput.MissingUnslash"/>
        <exclude name="WordPress.Security.ValidatedSanitizedInput.InputNotSanitized"/>
        <exclude name="WordPress.PHP.StrictInArray.MissingTrueStrict"/>
        <exclude name="WordPress.WP.EnqueuedResourceParameters.MissingVersion"/>
        
        <!-- Allow some coding patterns -->
        <exclude name="WordPress.PHP.DisallowShortTernary.Found"/>
        <exclude name="WordPress.PHP.YodaConditions.NotYoda"/>
        <exclude name="WordPress.WP.AlternativeFunctions.file_get_contents_file_get_contents"/>
        <exclude name="WordPress.WP.AlternativeFunctions.json_encode_json_encode"/>
        <exclude name="WordPress.PHP.DevelopmentFunctions.error_log_error_log"/>
        
        <!-- Allow base64 encoding for legitimate uses -->
        <exclude name="WordPress.PHP.DiscouragedPHPFunctions.obfuscation_base64_encode"/>
        <exclude name="WordPress.PHP.DiscouragedPHPFunctions.obfuscation_base64_decode"/>
        
        <!-- Allow date() function -->
        <exclude name="WordPress.DateTime.RestrictedFunctions.date_date"/>
        
        <!-- Allow database prepare usage patterns -->
        <exclude name="WordPress.DB.PreparedSQL.InterpolatedNotPrepared"/>
        
        <!-- Allow mixed OO and functions in main plugin file -->
        <exclude name="Universal.Files.SeparateFunctionsFromOO.Mixed"/>
        
        <!-- Allow reasonable method patterns -->
        <exclude name="WordPress.NamingConventions.ValidFunctionName.MethodNameInvalid"/>
        
        <!-- Allow reasonable output patterns -->
        <exclude name="WordPress.Security.EscapeOutput.OutputNotEscaped"/>
        
        <!-- Allow reasonable nonce patterns -->
        <exclude name="WordPress.Security.NonceVerification.Recommended"/>
        <exclude name="WordPress.Security.NonceVerification.Missing"/>
        
        <!-- Allow reasonable global access patterns -->
        <exclude name="WordPress.WP.GlobalVariablesOverride.Prohibited"/>
        
        <!-- Allow missing translator comments for now -->
        <exclude name="WordPress.WP.I18n.MissingTranslatorsComment"/>
        
        <!-- Allow unused function parameters (often required by WordPress hooks) -->
        <exclude name="Generic.CodeAnalysis.UnusedFunctionParameter.Found"/>
        <exclude name="Generic.CodeAnalysis.UnusedFunctionParameter.FoundAfterLastUsed"/>
    </rule>
</ruleset>